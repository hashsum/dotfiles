function hlf(a,b){I(a,1,b)}function ilf(){var a=AL.getInstance();return new vm(function(b,c){UQd(a,"/dbx/schedules",function(d){var e=new Dj;e.Gg=!0;d=e.Nc(U4b.xa(),d.Ce());b(d)},c)})}function jlf(a){var b=AL.getInstance(),c=new Dj;c.Gg=!0;var d=c.serialize(a);return new vm(function(e,f){BL(b,"/dbx/createSchedule",[],d,function(h){c.Gg=!0;h=c.Nc(O4b.xa(),h.Ce());e(h)},f)})}
function klf(a){var b=AL.getInstance(),c=new Dj;c.Gg=!0;var d=c.serialize(a);return new vm(function(e,f){BL(b,"/dbx/updateSchedule",[],d,function(h){c.Gg=!0;h=c.Nc(S4b.xa(),h.Ce());e(h)},f)})}function llf(a){if(ritz_api.BigSheetsApi.isExternalDataForDatasourceSheetPreview(a))return!1;a=ritz_api.BigSheetsApi.getDbObjectTypeForExternalDataSourceId(a);return X6b.has(a)}function mlf(a){var b=[];a=ka(a.C.keys());for(var c=a.next();!c.done;c=a.next())c=c.value,llf(c)&&b.push(c);return b}
function nlf(a){if(a.F)return[];var b=[];a.C.forEach(function(c,d){N6b.has(c.D)&&llf(d)&&b.push(d)});return b}function olf(a,b){b=b.map(function(c){return new zrd(c.uq(),c.Sh())});Krd(a,b)}function plf(a,b,c,d){Hrd(a.L,b,function(e){var f=e.filter(function(h){return 3==h.Sh().getState()});olf(a,f);c(e)},function(e){olf(a,e);d(e)})}function qlf(a){a.Db()&&F8d(a.F)}function rlf(a,b){I8d.call(this,a,b)}t(rlf,I8d);rlf.prototype.V=function(){this.refresh()};
rlf.prototype.refresh=function(){if(this.Db()){var a=hB.isEnabled();a=this.J&&this.L&&a&&0<nlf(this.H).length;this.D.Na(a)}};rlf.prototype.R=n("Refresh all");function slf(a,b,c){b=c||b;a=a||{};a=""+Q(KY(Fv({title:"Connected sheets",Bu:"waffle-dataconnector-refresh-sidepane",dC:Iv(""+Q(Lz({icon:"docs-icon-img docs-icon-database"},b))),Tj:Iv('<div class="'+U("waffle-dataconnector-refresh-sidepane-container")+'"><div class="'+U("waffle-dataconnector-refresh-sidepane-refresh-widget")+'"></div></div><div class="'+U("waffle-dataconnector-refresh-sidepane-backdrop")+'"></div>'),EQ:!0,SQ:Iv('<div class="'+U("waffle-dataconnector-refresh-sidepane-footer-wrapper")+
'"></div>')},a),b));return T(a)};function tlf(){return T('<div class="'+U("waffle-dataconnector-refresh-all-pane")+'"><div class="'+U("waffle-dataconnector-refresh-all-stale-msg")+'">This panel may be out of date. Close and reopen it to display the latest information.</div><div class="'+U("waffle-dataconnector-refresh-all-datasources-container")+'"></div></div>')}
function ulf(){return T('<div class="'+U("waffle-dataconnector-refresh-all-dbobject-list-items-container")+'"></div><div class="'+U("waffle-dataconnector-refresh-all-dbobject-list-footer-container")+'"></div>')}function vlf(a,b,c){b=c||b;return T('<div class="'+U("waffle-dataconnector-refresh-all-dbobject-list-single-datasource-title")+'"></div>'+ulf(null,b))}
function wlf(){return T('<div class="'+U("waffle-dataconnector-refresh-all-dbobject-list-footer")+'"><div class="'+U("waffle-dataconnector-refresh-all-dbobject-list-footer-bytes-wrapper")+'"></div><div class="'+U("waffle-dataconnector-refresh-all-dbobject-list-footer-button-wrapper")+'"></div></div>')}
function xlf(a){a=a.title;return T('<div class="'+U("waffle-dataconnector-refresh-all-dbobject-item")+'" tabindex="0"><div class="'+U("waffle-dataconnector-refresh-all-dbobject-item-icon-wrapper")+'"><div class="'+U("waffle-dataconnector-refresh-all-dbobject-item-icon-refresh")+'">'+Q(MRd())+'</div><div class="'+U("waffle-dataconnector-refresh-all-dbobject-item-icon-spinner")+'"></div></div><div class="'+U("waffle-dataconnector-refresh-all-dbobject-item-title")+'">'+Q(a)+'</div><div class="'+U("waffle-dataconnector-refresh-all-dbobject-item-status-wrapper")+
'"><div class="'+U("waffle-dataconnector-refresh-all-dbobject-item-timestamp")+'"></div><div class="'+U("waffle-dataconnector-refresh-all-dbobject-item-error")+'">Error</div><div class="'+U("waffle-dataconnector-refresh-all-dbobject-item-loading")+'">Loading\u2026</div><div class="'+U("waffle-dataconnector-refresh-all-dbobject-item-running")+'">Running\u2026</div></div></div>')};function ylf(a,b,c,d){P.call(this,d);this.D=a;this.L=b;this.J=c;this.H=new JRd;this.C=new HX(!1);this.F=!0}t(ylf,P);r=ylf.prototype;r.Ba=function(){this.wb(W(xlf,{title:this.L}))};r.Ha=function(){P.prototype.Ha.call(this);V(this.Ka(),"waffle-dataconnector-refresh-all-dbobject-item-enabled");this.C.render(this.Ea("waffle-dataconnector-refresh-all-dbobject-item-icon-spinner"));this.getHandler().listen(this.Ka(),"click",this.kNa).listen(this.Ka(),"keydown",this.XPb);zlf(this)};
function zlf(a){var b=WQd(a.J,a.D);switch(b.getType()){case "invalid-db-object":case "insufficient-access":case "fetch-failed":Alf(a,"waffle-dataconnector-refresh-all-dbobject-item-error");Blf(a);break;case "offline":Blf(a);break;case "loading":Alf(a,"waffle-dataconnector-refresh-all-dbobject-item-loading");Clf(a);break;case "fetching-results":Alf(a,"waffle-dataconnector-refresh-all-dbobject-item-running");Clf(a);break;case "no-results":Dlf(a);Blf(a);break;case "fetch-successful":b=b.C.pv();b=a.H.format(b);
Kt(a.Ea("waffle-dataconnector-refresh-all-dbobject-item-timestamp"),b);Alf(a,"waffle-dataconnector-refresh-all-dbobject-item-timestamp");Blf(a);break;case "do-not-show":break;default:throw Error("Unexpected DbObjectUiStateType");}}r.Na=function(a){this.F=a;var b=this.Ka();a?gw(b,"waffle-dataconnector-refresh-all-dbobject-item-disabled","waffle-dataconnector-refresh-all-dbobject-item-enabled"):gw(b,"waffle-dataconnector-refresh-all-dbobject-item-enabled","waffle-dataconnector-refresh-all-dbobject-item-disabled")};
function Alf(a,b){Dlf(a);N(a.Ea(b),!0)}function Blf(a){a.C.setActive(!1);N(a.Ea("waffle-dataconnector-refresh-all-dbobject-item-icon-spinner"),!1);N(a.Ea("waffle-dataconnector-refresh-all-dbobject-item-icon-refresh"),!0)}function Clf(a){a.C.setActive(!0);N(a.Ea("waffle-dataconnector-refresh-all-dbobject-item-icon-refresh"),!1);N(a.Ea("waffle-dataconnector-refresh-all-dbobject-item-icon-spinner"),!0)}r.XPb=function(a){13===a.keyCode&&this.kNa()};
r.kNa=function(){if(this.F){var a=new vG("refresh-db-object-request");a.wAa=this.D;this.dispatchEvent(a)}};function Dlf(a){["waffle-dataconnector-refresh-all-dbobject-item-timestamp","waffle-dataconnector-refresh-all-dbobject-item-error","waffle-dataconnector-refresh-all-dbobject-item-loading","waffle-dataconnector-refresh-all-dbobject-item-running"].forEach(function(b){return N(a.Ea(b),!1)})};function Elf(a,b,c,d,e){P.call(this,e);this.L=new Set(a);this.J=b;this.H=[];this.F=c;this.D=this.C=null;d&&(this.C=new Flf(this.qa()),this.D=new EZ(this.F,this.qa(),!0,!0));this.R=new Map([[1,0],[2,0],[3,0],[4,0],[5,0]])}t(Elf,P);Elf.prototype.Ba=function(){this.D?(this.D.render(),this.wb(this.D.Ka()),this.D.setContent(W(ulf))):this.wb(W(vlf))};
Elf.prototype.Ha=function(){var a=this;P.prototype.Ha.call(this);this.D||Kt(this.Ea("waffle-dataconnector-refresh-all-dbobject-list-single-datasource-title"),this.F);Glf(this);var b=this.getHandler();this.H.forEach(function(c){b.listen(c,"refresh-db-object-request",function(d){d=d.wAa;N6b.has(WQd(a.J,d).D)&&cmb.Eb([d])})});this.C&&(this.C.render(this.Ea("waffle-dataconnector-refresh-all-dbobject-list-footer-container")),b.listen(this.C,"action",this.V))};
function Glf(a){var b=a.Ea("waffle-dataconnector-refresh-all-dbobject-list-items-container");a.L.forEach(function(c){var d=ritz_api.BigSheetsApi.getDbObjectTypeForExternalDataSourceId(c);d=Hlf(a,d);c=new ylf(c,d,a.J,a.qa());a.H.push(c);c.render(b)})}
function Hlf(a,b){switch(b){case 1:return"Pivot table "+Ilf(a,1);case 2:return"Chart "+Ilf(a,2);case 3:return"Function "+Ilf(a,3);case 4:return"Connected sheet "+Ilf(a,4);case 5:return"Extract "+Ilf(a,5);default:throw Error("Unexpected DbObjectType");}}function Ilf(a,b){var c=a.R.get(b);a.R.set(b,c+1);return 0==c?"":c.toString()}Elf.prototype.V=function(){var a=this,b=Array.from(this.L).filter(function(c){return N6b.has(WQd(a.J,c).D)});cmb.Eb(b)};
function Jlf(a){a.H.forEach(function(b){return zlf(b)})}function Klf(a,b){a.C&&(b=b.filter(function(c){return a.L.has(c.uq())}),Llf(a.C,b))}function Mlf(a,b){a.F=b;a.D?a.D.getHeader().setContent(b):Kt(a.Ea("waffle-dataconnector-refresh-all-dbobject-list-single-datasource-title"),b)}Elf.prototype.Na=function(a){this.C&&this.C.Na(a);this.H.forEach(function(b){return b.Na(a)})};function Flf(a){P.call(this,a);this.D=new ZT("Refresh",this.qa());this.Ga(this.D);this.C=new E8d;this.Ga(this.C)}t(Flf,P);
Flf.prototype.Ba=function(){this.wb(W(wlf))};Flf.prototype.Ha=function(){P.prototype.Ha.call(this);this.D.render(this.Ea("waffle-dataconnector-refresh-all-dbobject-list-footer-button-wrapper"));this.C.render(this.Ea("waffle-dataconnector-refresh-all-dbobject-list-footer-bytes-wrapper"))};function Llf(a,b){var c=0;b.forEach(function(d){return c+=parseInt(H(d,2),10)});H8d(a.C,c);a.D.Na(!0)}Flf.prototype.Na=function(a){this.D.Na(a)};function Nlf(a,b){P.call(this,b);this.F=a;this.D=a.oa;this.C=[]}t(Nlf,P);Nlf.prototype.Ba=function(){this.wb(W(tlf))};Nlf.prototype.Ha=function(){var a=this;P.prototype.Ha.call(this);Olf(this);1<this.C.length&&this.C[0].D.getHeader().Yb(!0);N(this.Ea("waffle-dataconnector-refresh-all-stale-msg"),!1);this.getHandler().listen(this.F.C,"fa",function(b){return Plf(a,b)})};
function Olf(a){var b=Qlf(a);if(1==b.size){var c=b.entries().next().value;b=c[1];c=Rlf(a,c[0]);b=new Elf(b,a.D,c,!1,a.qa());a.C.push(b);b.render(a.Ea("waffle-dataconnector-refresh-all-datasources-container"))}else{c=ka(b.keys());for(var d=c.next();!d.done;d=c.next()){var e=d.value;d=Rlf(a,e);e=b.get(e);d=new Elf(e,a.D,d,!0,a.qa());a.C.push(d);d.render(a.Ea("waffle-dataconnector-refresh-all-datasources-container"))}}}
function Qlf(a){var b=new Map;mlf(a.D).forEach(function(c){var d=ritz_api.BigSheetsApi.getDataSourceIdForExternalDataId(c);b.has(d)?b.get(d).push(c):b.set(d,[c])});return b}function Rlf(a,b){b=ritz_api.BigSheetsApi.getSheetIdForDatasourceId(b);return vI(a.F.C,b).Nd()}function Slf(a,b){a.C.forEach(function(c){return Klf(c,b)})}function Tlf(a){a.C.forEach(function(b){b.C&&G8d(b.C.C)})}function Ulf(a){a.C.forEach(function(b){b.C&&(b=b.C,F8d(b.C),b.D.Na(!1))})}
function Vlf(a){a.C.forEach(function(b){return Jlf(b)})}Nlf.prototype.Na=function(a){this.C.forEach(function(b){return b.Na(a)})};function Plf(a,b){3==vI(a.F.C,b.Tg).getSheetType()&&(a=a.C.find(function(c){return c.F==b.C}))&&Mlf(a,b.jl)}var Wlf={"margin-top":"-43px"},Xlf={"margin-top":"0"},Ylf={Xi:"margin-top",duration:.1,timing:"ease-out",delay:0};function Zlf(a,b,c){b=void 0===b?dV.getInstance():b;kx.call(this,"",void 0,c);a&&$lf(a);this.C=new amf(a,b,c);this.Ga(this.C)}t(Zlf,kx);r=Zlf.prototype;r.Ba=function(){this.C.Ba();this.wb(this.C.Ka())};r.Mc=function(a){a.nm(!0);this.C.Mc(a)};r.ot=function(a,b){a.nm(!0);this.C.ot(a,b)};r.tf=function(a){return this.C.tf(a)};r.Jh=function(){return this.C.Jh()};r.Ad=function(){return this.C.C.map(function(a){return a.getValue()})};
function bmf(a,b){a=a.C;for(var c=ka(a.C),d=c.next();!d.done;d=c.next())d.value.Yb(!1);if(0==b.length)a.C=[];else{c=[];d=b.length;for(var e=0;e<a.Jh();e++){var f=a.tf(e),h=f.getValue();if(0<=b.indexOf(h)&&(f.Yb(!0),c.push(f),0==--d))break}a.C=c}a.fC()}r.Ob=function(){return this.C.Ob()};r.Ee=function(a){$lf(a);this.C.Ee(a)};r.Pd=function(a){this.C.Pd(a)};function $lf(a){for(var b=0;b<a.Kc();b++)a.Ec(b).nm(!0)}function amf(a,b,c){b=void 0===b?dV.getInstance():b;TY.call(this,a,b,c);this.C=[]}
t(amf,TY);amf.prototype.Ee=function(a){TY.prototype.Ee.call(this,a);this.C=[];this.fC()};amf.prototype.Tt=function(a){a.stopPropagation();a=a.target;if(a.isChecked()){var b=this.Ob();sW(this.C,a,function(c,d){return ed(yv(b,c),yv(b,d))})}else Wc(this.C,a);this.fC();this.dispatchEvent("change")};amf.prototype.D=function(){var a;0==this.C.length?a=this.F:a=this.C.map(function(b){return b.Ag()}).join(", ");return a||""};function cmf(){var a='<div class="'+U("waffle-dataconnector-refresh-schedules-widget")+'"><div class="'+U("waffle-dataconnector-refresh-schedules-header")+'"><div class="'+U("waffle-dataconnector-refresh-schedules-top-section")+'"><div class="'+U("waffle-dataconnector-refresh-schedules-header-title")+'"><span tabindex="0" class="'+U("waffle-dataconnector-refresh-schedules-title")+'">';a=a+'Scheduled refresh</span></div><div class="'+(U("waffle-dataconnector-refresh-schedules-enable-switch")+'"></div></div><div class="'+
U("waffle-dataconnector-refresh-schedules-spinner")+'"></div><div class="'+U("waffle-dataconnector-refresh-schedules-setup-btn")+'"></div><div class="'+U("waffle-dataconnector-refresh-schedules-overview-section")+'"><span class="'+U("waffle-dataconnector-refresh-schedules-overview-text")+'"></span><span class="'+U("waffle-dataconnector-refresh-schedules-edit-btn")+'"></span></div><div class="'+U("waffle-dataconnector-refresh-schedules-fullview-section")+'"><div class="waffle-dataconnector-refresh-schedules-fullview-text"></div><div><span class="'+
U("waffle-dataconnector-refresh-schedules-timezone-setting-btn")+'"></span> - ');a=a+'based on timezone set up in this spreadsheet</div></div></div><div class="'+(U("waffle-dataconnector-refresh-schedules-edit-section")+'"><div class="'+U("waffle-dataconnector-refresh-schedules-edit-section-row")+'"><label for="waffle-dataconnector-refresh-schedule-frequency" class="'+U("waffle-dataconnector-refresh-schedules-edit-section-row-label")+'">');a=a+'Frequency</label><div class="'+(U("waffle-dataconnector-refresh-schedules-frequency-select")+
" "+U("waffle-dataconnector-refresh-schedules-select")+'"></div></div><div class="'+U("waffle-dataconnector-refresh-schedules-edit-section-row")+" "+U("waffle-dataconnector-refresh-schedules-edit-section-row-date")+'"><label for="waffle-dataconnector-refresh-schedule-date" class="'+U("waffle-dataconnector-refresh-schedules-edit-section-row-label")+'">');a=a+'On date</label><div class="'+(U("waffle-dataconnector-refresh-schedules-date-select")+" "+U("waffle-dataconnector-refresh-schedules-select")+
'"></div></div><div class="'+U("waffle-dataconnector-refresh-schedules-edit-section-row")+'"><label for="waffle-dataconnector-refresh-schedule-time" class="'+U("waffle-dataconnector-refresh-schedules-edit-section-row-label")+'">');a=a+'Between</label><div class="'+(U("waffle-dataconnector-refresh-schedules-time-select")+" "+U("waffle-dataconnector-refresh-schedules-select")+'"></div></div><div class="'+U("waffle-dataconnector-refresh-schedules-owner-info")+'"></div><div class="'+U("waffle-dataconnector-refresh-schedules-btns")+
'"><div class="'+U("waffle-dataconnector-refresh-schedules-cancel-btn")+'"></div><div class="'+U("waffle-dataconnector-refresh-schedules-save-btn")+'"></div></div></div></div>');return T(a)};var dmf=new rA(7),emf=new rA(tA.MONTH_DAY_ABBR),fmf=new mz("{DAY, selectordinal, one {#st}two {#nd}few {#rd}other {#th}}");
function gmf(a,b,c){P.call(this,c);this.Ma=a;a=new Rx;a.Ga(new Mx("Every day",1),!0);a.Ga(new Mx("Every week",2),!0);a.Ga(new Mx("Every month",3),!0);this.H=new TY(a,dV.getInstance(),c);ky(this.H,"Add frequency");this.H.Pd("waffle-dataconnector-refresh-schedule-frequency");this.Ga(this.H);this.F=new Zlf(void 0,dV.getInstance(),c);ky(this.F.C,"Add date");this.F.Pd("waffle-dataconnector-refresh-schedule-date");this.Ga(this.F);a=new Rx;for(var d=new Date(Na()),e=Array(24),f=0;24>f;f++){d.setHours(f,
0,0,0);var h=new Date(d.getTime()),k=new Date(d.getTime());k.setHours(h.getHours()+4);k=hmf(h,k);e[h.getHours()]={value:f,label:k}}for(d=0;24>d;d++)f=new Mx(e[d].label,e[d].value),a.Ga(f,!0);this.J=new TY(a,dV.getInstance(),c);ky(this.J,"Add time");this.J.Pd("waffle-dataconnector-refresh-schedule-time");this.Ga(this.J);this.L=new qP("Cancel");this.Ga(this.L);this.V=new gA("Save",c);this.V.Na(!1);this.Ga(this.V);this.ea=new Ix("",rN.getInstance(),c);this.Ga(this.ea);this.Ca=new Ix("Setup now",rN.getInstance(),
c);this.Ga(this.Ca);this.Aa=new Ix("",rN.getInstance(),c);this.Ga(this.Aa);this.D=new $U(c);this.D.We("Enable schedule");this.Ga(this.D);this.gb=3;this.C=null;this.Fa=new D9d(500,500,"dbxScheduleOnCompleteAuth");this.va(this.Fa);this.oa=b;this.R=new g$d(c);this.R.Lc("waffle-dataconnector-refresh-schedules-info-icon");this.R.setVisible(!1);this.Oa=new HX(!0);this.Ia=!1}t(gmf,P);r=gmf.prototype;
r.Ba=function(){P.prototype.Ba.call(this);this.wb(W(cmf));this.R.C.setContent(re("All connected sheets & valid related objects in this document (pivot tables, charts, extracts and functions) will be refreshed."));this.R.render(this.Ea("waffle-dataconnector-refresh-schedules-header-title"))};
r.Ha=function(){P.prototype.Ha.call(this);this.L.render(this.Ea("waffle-dataconnector-refresh-schedules-cancel-btn"));this.ea.render(this.Ea("waffle-dataconnector-refresh-schedules-edit-btn"));this.D.render(this.Ea("waffle-dataconnector-refresh-schedules-enable-switch"));this.H.render(this.Ea("waffle-dataconnector-refresh-schedules-frequency-select"));this.V.render(this.Ea("waffle-dataconnector-refresh-schedules-save-btn"));this.Ca.render(this.Ea("waffle-dataconnector-refresh-schedules-setup-btn"));
this.Aa.render(this.Ea("waffle-dataconnector-refresh-schedules-timezone-setting-btn"));this.J.render(this.Ea("waffle-dataconnector-refresh-schedules-time-select"));this.F.render(this.Ea("waffle-dataconnector-refresh-schedules-date-select"));this.Oa.render(this.Ea("waffle-dataconnector-refresh-schedules-spinner"));imf(this,!1);this.getHandler().listen(this.ea,"action",this.QRb).listen(this.L,"action",this.sRb).listen(this.V,"action",this.eTb).listen(this.Ca,"action",this.iTb).listen(this.D,"action",
this.RRb).listen(this.H,"change",this.bSb).listen(this.F,"change",this.L1).listen(this.J,"change",this.L1).listen(this.Aa,"action",this.ATb);0<Array.from(this.Ma.C.keys()).length?(N(this.Ka(),!0),jmf(this)):N(this.Ka(),!1)};
function kmf(a){if(!a.isDisposed()){var b=a.Ea("waffle-dataconnector-refresh-schedules-edit-section"),c=a.Ea("waffle-dataconnector-refresh-schedules-overview-section"),d=a.Ea("waffle-dataconnector-refresh-schedules-fullview-section"),e=a.Ea("waffle-dataconnector-refresh-schedules-owner-info"),f=a.Ea("waffle-dataconnector-refresh-schedules-setup-btn"),h=a.Ea("waffle-dataconnector-refresh-schedules-enable-switch"),k=a.Ea("waffle-dataconnector-refresh-schedules-spinner");N(f,!1);N(h,!1);N(b,!1);N(c,
!1);N(d,!1);N(e,!1);N(k,!1);ew(a.Ka(),"waffle-dataconnector-refresh-schedules-widget-opened",!1);var l=!1;a.R.setVisible(!1);switch(a.gb){case 1:N(f,!0);break;case 2:N(d,!0);N(b,!0);N(e,!0);ew(a.Ka(),"waffle-dataconnector-refresh-schedules-widget-opened",!0);l=!0;lmf(a);mmf(a);a.L1();a.L.Na(!0);a.R.setVisible(!0);break;case 3:N(k,!0);break;case 5:N(d,!0);N(h,!0);N(b,!0);N(e,!0);ew(a.Ka(),"waffle-dataconnector-refresh-schedules-widget-opened",!0);l=!0;nmf(a);lmf(a);mmf(a);b=H(a.C,2);a.D.Yb(!!H(b,1));
c=b.In().In();a.H.setValue(c);switch(c){case 1:imf(a,!1);break;case 2:bmf(a.F,Qf(b.In(),4));imf(a,!0);break;case 3:bmf(a.F,Qf(b.In(),5)),imf(a,!0)}a.J.setValue(H(b.In(),2));a.L1();a.L.Na(!0);a.R.setVisible(!0);break;case 4:N(h,!0),N(c,!0),nmf(a),c=a.Ea("waffle-dataconnector-refresh-schedules-overview-text"),omf(a)?(b=a.C.getStatus(),Kt(c,"Next: "),c=new Date(1E3*H(b,2)),b=new Date(1E3*H(b,3)),a.ea.setContent(Vt(a.qa(),pmf(c,b,a.oa,!0)))):(Kt(c,"Paused"),a.ea.setContent("Edit"))}a.Ia!=l&&(a.Ia=l,a.dispatchEvent(l?
"ai":"$h"))}}function nmf(a){var b=!!H(H(a.C,2),1);a.D.Yb(b);a.D.Na(!0)}function lmf(a){var b=a.Ea("waffle-dataconnector-refresh-schedules-owner-info"),c="Will run as you.";a.C&&(a=H(H(a.C,4),1))&&(c+=" Currently running as "+a);Kt(b,c)}
function mmf(a){var b=a.Ea("waffle-dataconnector-refresh-schedules-fullview-text");if(omf(a)){var c=a.C.getStatus(),d=new Date(1E3*H(c,2));c=new Date(1E3*H(c,3));var e=a.qa();e.Zc(b);e.appendChild(b,Vt(e,ve(re("Next: "),pmf(d,c,a.oa,!1))))}else Kt(b,"");a.Aa.setContent(qmf(a.oa))}function omf(a){return a.C&&H(H(a.C,2),1)?(H(a.C.getStatus(),1),!0):!1}r.sRb=function(){this.gb=2==this.gb?1:4;kmf(this);this.Ea("waffle-dataconnector-refresh-schedules-title").focus()};r.QRb=function(){this.gb=5;kmf(this)};
r.bSb=function(){var a=this.H.getValue();bmf(this.F,[]);switch(a){case 1:imf(this,!1);break;case 2:imf(this,!0);a=this.F.Ee(rmf());E(a);break;case 3:imf(this,!0),a=this.F.Ee(smf()),E(a)}this.L1()};
r.eTb=function(){this.V.Na(!1);this.L.Na(!1);var a=this.H.getValue(),b=new LK,c=new NK;c.UB(a);if(2===a){var d=ka(this.F.Ad());for(a=d.next();!a.done;a=d.next())Of(c,4,a.value)}else if(3===a)for(d=ka(this.F.Ad()),a=d.next();!a.done;a=d.next())Of(c,5,a.value);a=this.J.getValue();I(c,2,a);b.UB(c);I(b,3,1);2==this.gb?(b.Na(!0),tmf(this,b,null)):(b.Na(this.D.isChecked()),umf(this,b,null))};r.iTb=function(){this.gb=2;kmf(this)};
r.RRb=function(){var a=this;if(4==this.gb){var b=H(this.C,2),c=this.D.isChecked();this.D.Yb(!c);this.D.Na(!1);if(c){var d=vmf(this);d.render();d.setVisible(!0);d.getResult().then(function(){E(d);b.Na(c);umf(a,b,null)},function(){E(d)})}else b.Na(c),umf(this,b,null)}};r.ATb=function(){qD.Eb()};r.L1=function(){var a=!!this.H.bf(),b=1===this.H.getValue()||0<this.F.Ad().length,c=!!this.J.bf();this.V.Na(a&&b&&c)};
function tmf(a,b,c,d){d=void 0===d?!0:d;var e=new M4b;I(e,1,b);c&&I(e,2,c);jlf(e).then(function(f){return wmf(a,b,f.getStatus(),H(f,2),!0,d)},function(){xmf(a)})}function umf(a,b,c,d){d=void 0===d?!0:d;var e=new Q4b;hlf(e,a.C.getId());I(e,2,b);c&&I(e,3,c);klf(e).then(function(f){return wmf(a,b,f.getStatus(),H(f,2),!1,d)},function(){xmf(a)})}
function wmf(a,b,c,d,e,f){a.D.Na(!0);switch(c){case 1:a.Ea("waffle-dataconnector-refresh-schedules-title").focus();jmf(a);break;case 2:if(!f)break;E9d(a.Fa,d,function(h){a.isDisposed()||(a.D.Na(!1),e?tmf(a,b,h,!1):umf(a,b,h,!1))});break;default:xmf(a)}}function jmf(a){a.gb=3;kmf(a);ilf().then(function(b){a.isDisposed()||(b=Qf(b,1),0==b.length?(a.gb=1,a.C=null):(a.gb=4,a.C=b[0]),kmf(a))},function(){Ry.getInstance().postMessage(Ty("Error loading schedule configuration.","error",!0))})}
function imf(a,b){N(a.Ea("waffle-dataconnector-refresh-schedules-edit-section-row-date"),b)}
function vmf(a){var b=new A$d;b.Lc("waffle-dataconnector-refresh-schedules-resume-prompt");b.setTitle("Resume scheduled refresh?");b.C.setContent("Resume");b.H.setContent("Cancel");var c=H(a.C,2);switch(c.In().In()){case 1:var d="Daily";break;case 2:d=ymf();var e=Qf(c.In(),4);d="Weekly on "+(d.filter(function(l){return e.includes(l.value)}).map(function(l){return l.label}).join(", ")+" ");break;case 3:d="Monthly on the "+(Qf(c.In(),5).map(function(l){return fmf.format({DAY:l})}).join(", ")+" ")}var f=
a.C.getStatus();c=zmf(a.oa);var h=new Date(Na()),k=new Date(1E3*H(f,2));f=new Date(1E3*H(f,3));d+=hmf(k,f,c)+" ("+vgb(c.C-qA(c,h))+")";a="Will run as "+H(H(a.C,4),1);a=ve(re("All connected sheets & valid related objects in this document (pivot tables, charts, extracts and functions) will be refreshed."),te("H4",void 0,"Schedule"),re(d),te("BR"),re(a));pw(b,a);return b}function xmf(a){Ry.getInstance().postMessage(Ty("Error saving schedule.","error",!0));a.V.Na(!0);a.L.Na(!0);a.D.Na(!0)}
function ymf(){var a=(lA.FIRSTDAYOFWEEK+1)%7,b=lA.WEEKDAYS.map(function(c,d){return{label:c,value:(d+6)%7+1}});return b.slice(a).concat(b.slice(0,a))}function rmf(){var a=new Rx,b=ymf();b=ka(b);for(var c=b.next();!c.done;c=b.next())c=c.value,a.Ga(new Mx(c.label,c.value),!0);return a}function smf(){for(var a=new Rx,b=1;28>=b;b++)a.Ga(new Mx(fmf.format({DAY:b}),b),!0);return a}function hmf(a,b,c){return dmf.format(a,c)+" - "+dmf.format(b,c)}
function pmf(a,b,c,d){var e=new xA,f=zmf(c);f=emf.format(a,f)+" \u00b7 "+hmf(a,b,f);a.getDate()!==b.getDate()&&(f+=e.bd("sup")+"+1"+e.$c("sup"));d&&(f+=" ("+qmf(c)+")");return e.format(f)}function qmf(a){var b=new Date(Na());a=zmf(a);return vgb(a.C-qA(a,b))}function zmf(a){a=-1*a.getTimezoneOffset(new Date(Na()));return pA(a/6E4)};function Amf(a,b,c){VX.call(this,c);this.V=b;this.J=b.oa;this.R=a;this.Gx=new Nlf(b,this.qa());this.Ga(this.Gx);this.D=new rlf(this.J,c);this.va(this.D);this.H=this.F=null}t(Amf,VX);Amf.prototype.Ba=function(){VX.prototype.Ba.call(this);this.wb(W(slf,{id:this.getId(),Od:!0}));this.D.render(this.Ea("waffle-dataconnector-refresh-sidepane-footer-wrapper"))};
Amf.prototype.Ha=function(){var a=this;VX.prototype.Ha.call(this);B(A(),"fedsr")&&(Bmf(this),this.getHandler().listen(this,["$h","ai"],this.L));this.Gx.render(this.Ea("waffle-dataconnector-refresh-sidepane-refresh-widget"));this.getHandler().listen(this.D,"refresh-db-object-request",function(){var b=nlf(a.J);cmb.Eb(b)});this.D.refresh();N(this.Ea("waffle-dataconnector-refresh-sidepane-backdrop"),!1)};
function Cmf(a,b){Slf(a.Gx,b);var c=0;b.forEach(function(d){return c+=parseInt(H(d,2),10)});a.D.eC(c)}Amf.prototype.L=function(a){a="ai"===a.type;N(this.Ea("waffle-dataconnector-refresh-sidepane-backdrop"),a);E(this.H);a&&(a=this.F.Ka(),this.H=new Yz(a,this.qa()),this.va(this.H),Zz(this.H),a.focus())};function Bmf(a){a.F=new gmf(a.J,a.R,a.qa());a.Ga(a.F);a.F.render(a.Ka());N(a.Ea("waffle-dataconnector-refresh-sidepane-backdrop"),!1)};function Dmf(a,b,c){dX.call(this,a,b);var d=this;this.C=c;this.D=new Vl;this.va(this.D);Zl(this.D,this.C.D,function(e){if("dbobjectmodel-event-add"==e.getType()||"dbobjectmodel-event-remove"==e.getType()){e=d.O.Gx.Ea("waffle-dataconnector-refresh-all-stale-msg");if(!lv(e)){var f=new Mw(e,.1,Wlf,Xlf,Ylf);N(e,!0);f.play()}e=d.O;e.Gx.Na(!1);e.D.D.Na(!1)}Emf(d);Vlf(d.O.Gx);d.O.Ka().focus()});this.La.listen(RJ,"show-db-objects-refresh-sidepane",this.F)}t(Dmf,dX);Dmf.prototype.zf=function(){return emb};
Dmf.prototype.xo=function(){return fmb};function Emf(a){var b=nlf(a.C),c=a.O;0==b.length?qlf(c.D):(Tlf(c.Gx),J8d(c.D),plf(a.C,b,function(d){a.isDisposed()||c.isDisposed()||Cmf(c,d)},function(d){if(!a.isDisposed()&&!c.isDisposed()){d=new zrd(d[0].uq(),d[0].Sh());Ulf(c.Gx);var e=c.D;e.Db()&&(e=e.F,e.F=d,F8d(e),N(e.Ea("waffle-dbobject-estimated-bytes-error"),!0),e.C.setActive(!1))}}))}
Dmf.prototype.F=function(){var a=this.O;E(a.Gx);a.Gx=new Nlf(a.V,a.qa());a.Ga(a.Gx);a.Gx.render(a.Ea("waffle-dataconnector-refresh-sidepane-refresh-widget"));a.D.refresh();a=this.O;null!=a.F&&(E(a.F),E(a.H),Bmf(a));Emf(this);eX(this);this.O.Ka().focus()};function Fmf(){LJ.apply(this,arguments)}t(Fmf,LJ);Fmf.prototype.C=function(){return Dmf};Fmf.prototype.D=function(){return Amf};PJ("dbrefresh",Fmf);
